<div class="accordion-container">

  <!-- ðŸ”„ Loading spinner -->
  <div *ngIf="isLoading" class="loading">
    <div class="spinner"></div>
    <p>Loading course sections...</p>
  </div>


  <div class="accordion-container">

    <!-- ðŸ”„ Loading spinner -->
    <div *ngIf="isLoading" class="loading">
      <div class="spinner"></div>
      <p>Loading course sections...</p>
    </div>

    <!-- ðŸ”¹ Section Accordion -->
    <div *ngFor="let section of sections" class="accordion" (click)="handleSectionClick(section._id!)"
      [class.active]="activeSectionId === section._id">

      <!-- Section Header -->
      <div class="accordion-header">
        <div class="section-label">ðŸ“˜ {{ section.sectionName }}</div>
        <div class="section-title">{{ section.description || 'No Description' }}</div>
        <div class="icon-hand" title="Click to expand">ðŸ‘†</div>
      </div>

      <!-- Section Body -->
      <div class="accordion-body" *ngIf="activeSectionId === section._id">

        <!-- Loader inside section -->
        <div *ngIf="isSectionLoading" class="loading-modules">
          <div class="spinner small"></div>
          <p>Loading modules...</p>
        </div>

        <!-- Modules List -->
        <div *ngIf="section.modules && section.modules.length > 0; else noModules">
          <div class="row">
            <div class="module col-md-6 col-12" *ngFor="let module of section.modules; let i = index"
              [ngClass]="{'not-accessible': !userAccessibleSections.includes(section._id!)}">

              <!-- Module Number -->
              <div class="module-id">{{ i + 1 }}</div>

              <!-- Module Content -->
              <div class="module-content">
                <div class="module-title">{{ module.title }}</div>
                <div class="module-details">
                  {{ module.docsCount || 0 }} Docs, {{ module.videosCount || 0 }} Videos
                </div>
              </div>

              <!-- Module Action -->
              <button class="btn-status" (click)="onModuleClick(section._id!, module); $event.stopPropagation()">
                <span class="arrow">âž”</span>
              </button>
            </div>
          </div>
        </div>

        <ng-template #noModules>
          <div class="text-muted">No modules available for this section.</div>
        </ng-template>


        <!-- No Modules Template -->
        <ng-template #noModules>
          <p class="no-data">No modules available for this section.</p>
        </ng-template>

        <!-- Level Complete -->
        <div *ngIf="section.isActive" class="level-complete">
          âœ” Level - {{ section.sectionName }} Active
        </div>
      </div>
    </div>

    <!-- No Sections Fallback -->
    <div *ngIf="!isLoading && sections.length === 0" class="no-data">
      No course sections available.
    </div>
  </div>




  <!-- âŒ No Data Case -->
  <div *ngIf="!isLoading && sections.length === 0" class="no-data">
    No course sections available.
  </div>

</div>